2026-03-01 01:08:05.848 | INFO     | src.train:train_model:463 - Training model...
2026-03-01 01:08:09.543 | INFO     | src.train:train_model:576 - Using TimeSeriesSplit with 3 splits
2026-03-01 01:08:09.543 | INFO     | src.train:train_model:577 - Deep learning models use 30% validation split
2026-03-01 01:08:09.543 | INFO     | src.train:train_model:580 - Training Classical ML models...
2026-03-01 01:08:09.544 | INFO     | src.train:train_model:587 - 
Fitted Features: Index(['no', 'pm2_5', 'pm10', 'co', 'no2', 'so2', 'o3', 'nh3', 'hour', 'day',
       'month', 'weekday', 'season', 'pm2_5_pm10_ratio',
       'aqi_rolling_mean_24h', 'aqi_rolling_max_24h', 'aqi_above_3_count_24h',
       'aqi_trend'],
      dtype='object')
Target used: aqi
2026-03-01 01:08:09.544 | INFO     | src.train:train_model:588 - Fitting classical ML models...
2026-03-01 01:08:09.544 | INFO     | src.train:train_model:592 - Fitting SVC model...
2026-03-01 01:15:29.995 | INFO     | src.train:train_model:592 - Fitting KNN model...
2026-03-01 01:16:04.648 | INFO     | src.train:train_model:592 - Fitting RF model...
2026-03-01 01:17:04.002 | INFO     | src.train:train_model:592 - Fitting XGB model...
2026-03-01 01:17:30.973 | INFO     | src.train:train_model:605 - Training Deep Learning models with epoch-by-epoch logging...
2026-03-01 01:17:30.973 | INFO     | src.train:train_model:610 - Training GRU model...
2026-03-01 01:22:20.222 | INFO     | src.train:train_model:610 - Training LSTM model...
2026-03-01 01:26:45.780 | INFO     | src.train:train_model:610 - Training HYBRID model...
2026-03-01 01:32:49.175 | INFO     | src.train:train_model:650 - Evaluating svc on validation set...
2026-03-01 01:32:50.556 | INFO     | src.train:train_model:689 - svc - Accuracy: 0.960, F1: 0.962, Recall: 0.960, Precision: 0.964, ROC AUC: 0.999
2026-03-01 01:32:50.559 | INFO     | src.train:train_model:735 - Classical ML model saved to: /home/runner/work/aqi-healthy-air/aqi-healthy-air/models/svc_acc_0.960_roc_0.999.pkl
2026-03-01 01:32:50.559 | INFO     | src.train:train_model:650 - Evaluating knn on validation set...
2026-03-01 01:32:53.098 | INFO     | src.train:train_model:689 - knn - Accuracy: 0.931, F1: 0.929, Recall: 0.931, Precision: 0.928, ROC AUC: 0.991
2026-03-01 01:32:53.103 | INFO     | src.train:train_model:735 - Classical ML model saved to: /home/runner/work/aqi-healthy-air/aqi-healthy-air/models/knn_acc_0.931_roc_0.991.pkl
2026-03-01 01:32:53.104 | INFO     | src.train:train_model:650 - Evaluating rf on validation set...
2026-03-01 01:32:53.312 | INFO     | src.train:train_model:689 - rf - Accuracy: 0.973, F1: 0.977, Recall: 0.973, Precision: 0.982, ROC AUC: 1.000
2026-03-01 01:32:53.462 | INFO     | src.train:train_model:735 - Classical ML model saved to: /home/runner/work/aqi-healthy-air/aqi-healthy-air/models/rf_acc_0.973_roc_1.000.pkl
2026-03-01 01:32:53.463 | INFO     | src.train:train_model:650 - Evaluating xgb on validation set...
2026-03-01 01:32:53.599 | INFO     | src.train:train_model:689 - xgb - Accuracy: 0.981, F1: 0.984, Recall: 0.981, Precision: 0.987, ROC AUC: 1.000
2026-03-01 01:32:53.614 | INFO     | src.train:train_model:735 - Classical ML model saved to: /home/runner/work/aqi-healthy-air/aqi-healthy-air/models/xgb_acc_0.981_roc_1.000.pkl
2026-03-01 01:32:53.614 | INFO     | src.train:train_model:650 - Evaluating gru on validation set...
2026-03-01 01:32:55.593 | INFO     | src.train:train_model:689 - gru - Accuracy: 0.919, F1: 0.921, Recall: 0.919, Precision: 0.925, ROC AUC: 0.990
2026-03-01 01:32:55.637 | INFO     | src.train:train_model:709 - Deep learning model saved to: /home/runner/work/aqi-healthy-air/aqi-healthy-air/models/gru_acc_0.919_roc_0.990
2026-03-01 01:32:55.638 | INFO     | src.train:train_model:710 - Deep learning model zip created: /home/runner/work/aqi-healthy-air/aqi-healthy-air/models/gru_acc_0.919_roc_0.990.zip
2026-03-01 01:32:55.638 | INFO     | src.train:train_model:715 - Deep learning model gru logged to Neptune successfully
2026-03-01 01:32:55.638 | INFO     | src.train:train_model:650 - Evaluating lstm on validation set...
2026-03-01 01:32:57.616 | INFO     | src.train:train_model:689 - lstm - Accuracy: 0.915, F1: 0.918, Recall: 0.915, Precision: 0.925, ROC AUC: 0.991
2026-03-01 01:32:57.658 | INFO     | src.train:train_model:709 - Deep learning model saved to: /home/runner/work/aqi-healthy-air/aqi-healthy-air/models/lstm_acc_0.915_roc_0.991
2026-03-01 01:32:57.658 | INFO     | src.train:train_model:710 - Deep learning model zip created: /home/runner/work/aqi-healthy-air/aqi-healthy-air/models/lstm_acc_0.915_roc_0.991.zip
2026-03-01 01:32:57.659 | INFO     | src.train:train_model:715 - Deep learning model lstm logged to Neptune successfully
2026-03-01 01:32:57.659 | INFO     | src.train:train_model:650 - Evaluating hybrid on validation set...
2026-03-01 01:32:59.487 | INFO     | src.train:train_model:689 - hybrid - Accuracy: 0.913, F1: 0.915, Recall: 0.913, Precision: 0.919, ROC AUC: 0.990
2026-03-01 01:32:59.522 | INFO     | src.train:train_model:709 - Deep learning model saved to: /home/runner/work/aqi-healthy-air/aqi-healthy-air/models/hybrid_acc_0.913_roc_0.990
2026-03-01 01:32:59.522 | INFO     | src.train:train_model:710 - Deep learning model zip created: /home/runner/work/aqi-healthy-air/aqi-healthy-air/models/hybrid_acc_0.913_roc_0.990.zip
2026-03-01 01:32:59.523 | INFO     | src.train:train_model:715 - Deep learning model hybrid logged to Neptune successfully
2026-03-01 01:32:59.525 | INFO     | src.train:train_model:768 - Best model based on F1 score: xgb with F1: 0.984
2026-03-01 01:32:59.525 | INFO     | src.train:train_model:769 - Model rankings saved to: /home/runner/work/aqi-healthy-air/aqi-healthy-air/cv_results/val_model_performance.csv
2026-03-01 01:33:05.216 | INFO     | __main__:main:62 - Saving Model to Model Registry...
2026-03-01 01:33:05.217 | SUCCESS  | __main__:main:63 - Training instance complete...
2026-03-01 03:19:26.299 | INFO     | __main__:main:29 - Starting feature pipeline...
2026-03-01 03:19:26.302 | INFO     | __main__:main:33 - Data downloading from API...
2026-03-01 03:19:26.787 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2016-01-01 - 2016-03-01
2026-03-01 03:19:32.271 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2016-03-02 - 2016-05-01
2026-03-01 03:19:37.757 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2016-05-02 - 2016-07-01
2026-03-01 03:19:42.949 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2016-07-02 - 2016-08-31
2026-03-01 03:19:48.144 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2016-09-01 - 2016-10-31
2026-03-01 03:19:53.344 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2016-11-01 - 2016-12-31
2026-03-01 03:19:58.552 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2017-01-01 - 2017-03-02
2026-03-01 03:20:03.761 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2017-03-03 - 2017-05-02
2026-03-01 03:20:08.965 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2017-05-03 - 2017-07-02
2026-03-01 03:20:14.166 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2017-07-03 - 2017-09-01
2026-03-01 03:20:19.363 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2017-09-02 - 2017-11-01
2026-03-01 03:20:24.559 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2017-11-02 - 2018-01-01
2026-03-01 03:20:29.755 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2018-01-02 - 2018-03-03
2026-03-01 03:20:35.231 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2018-03-04 - 2018-05-03
2026-03-01 03:20:40.426 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2018-05-04 - 2018-07-03
2026-03-01 03:20:45.621 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2018-07-04 - 2018-09-02
2026-03-01 03:20:50.820 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2018-09-03 - 2018-11-02
2026-03-01 03:20:56.016 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2018-11-03 - 2019-01-02
2026-03-01 03:21:01.211 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2019-01-03 - 2019-03-04
2026-03-01 03:21:06.414 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2019-03-05 - 2019-05-04
2026-03-01 03:21:11.890 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2019-05-05 - 2019-07-04
2026-03-01 03:21:17.093 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2019-07-05 - 2019-09-03
2026-03-01 03:21:22.289 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2019-09-04 - 2019-11-03
2026-03-01 03:21:27.485 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2019-11-04 - 2020-01-03
2026-03-01 03:21:32.683 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2020-01-04 - 2020-03-04
2026-03-01 03:21:37.879 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2020-03-05 - 2020-05-04
2026-03-01 03:21:43.080 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2020-05-05 - 2020-07-04
2026-03-01 03:21:48.395 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2020-07-05 - 2020-09-03
2026-03-01 03:21:53.591 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2020-09-04 - 2020-11-03
2026-03-01 03:21:59.580 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2020-11-04 - 2021-01-03
2026-03-01 03:22:05.949 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2021-01-04 - 2021-03-05
2026-03-01 03:22:11.916 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2021-03-06 - 2021-05-05
2026-03-01 03:22:18.124 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2021-05-06 - 2021-07-05
2026-03-01 03:22:24.104 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2021-07-06 - 2021-09-04
2026-03-01 03:22:30.039 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2021-09-05 - 2021-11-04
2026-03-01 03:22:36.060 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2021-11-05 - 2022-01-04
2026-03-01 03:22:42.019 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2022-01-05 - 2022-03-06
2026-03-01 03:22:47.947 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2022-03-07 - 2022-05-06
2026-03-01 03:22:53.971 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2022-05-07 - 2022-07-06
2026-03-01 03:23:00.025 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2022-07-07 - 2022-09-05
2026-03-01 03:23:06.156 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2022-09-06 - 2022-11-05
2026-03-01 03:23:12.104 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2022-11-06 - 2023-01-05
2026-03-01 03:23:19.846 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2023-01-06 - 2023-03-07
2026-03-01 03:23:25.873 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2023-03-08 - 2023-05-07
2026-03-01 03:23:31.797 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2023-05-08 - 2023-07-07
2026-03-01 03:23:38.240 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2023-07-08 - 2023-09-06
2026-03-01 03:23:44.223 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2023-09-07 - 2023-11-06
2026-03-01 03:23:50.286 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2023-11-07 - 2024-01-06
2026-03-01 03:23:56.349 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2024-01-07 - 2024-03-07
2026-03-01 03:24:02.498 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2024-03-08 - 2024-05-07
2026-03-01 03:24:08.543 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2024-05-08 - 2024-07-07
2026-03-01 03:24:14.470 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2024-07-08 - 2024-09-06
2026-03-01 03:24:20.400 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2024-09-07 - 2024-11-06
2026-03-01 03:24:26.543 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2024-11-07 - 2025-01-06
2026-03-01 03:24:32.562 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2025-01-07 - 2025-03-08
2026-03-01 03:24:38.653 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2025-03-09 - 2025-05-08
2026-03-01 03:24:44.861 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2025-05-09 - 2025-07-08
2026-03-01 03:24:50.935 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2025-07-09 - 2025-09-07
2026-03-01 03:24:57.490 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2025-09-08 - 2025-11-07
2026-03-01 03:25:03.467 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2025-11-08 - 2026-01-07
2026-03-01 03:25:09.691 | INFO     | src.data_fetcher:fetch_data:90 - ✅ Data pulled for 2026-01-08 - 2026-03-01
2026-03-01 03:25:15.016 | INFO     | src.data_fetcher:fetch_data:111 - ✔ AQI Data saved to `aqi_data_2016-2026.csv`
2026-03-01 03:25:15.026 | INFO     | __main__:main:35 - Data download completed...
2026-03-01 03:25:15.026 | INFO     | __main__:main:37 - Data Loading & Cleaning...
2026-03-01 03:25:15.152 | INFO     | src.data_cleaner:clean_data:84 - 
Data Quality Report:  
Total rows: 43376
Total columns: 10
2026-03-01 03:25:15.153 | INFO     | src.data_cleaner:clean_data:85 - 
Missing values after cleaning:  
timestamp    0
aqi          0
no           0
pm2_5        0
pm10         0
co           0
no2          0
so2          0
o3           0
nh3          0
dtype: int64
2026-03-01 03:25:15.154 | INFO     | src.data_cleaner:clean_data:86 - 
Data types: 
timestamp    datetime64[ns]
aqi                 float64
no                  float64
pm2_5               float64
pm10                float64
co                  float64
no2                 float64
so2                 float64
o3                  float64
nh3                 float64
dtype: object
2026-03-01 03:25:15.154 | INFO     | __main__:main:41 - Data Loading & Cleaning Completed.
2026-03-01 03:25:15.154 | INFO     | __main__:main:43 - Feature Engineering...
2026-03-01 03:25:15.330 | INFO     | __main__:main:46 - Feature Engineering Completed.
2026-03-01 03:25:15.330 | INFO     | __main__:main:48 - Feature Selection...
2026-03-01 03:25:15.331 | INFO     | __main__:main:50 - Performing correlation analysis...
2026-03-01 03:25:15.365 | INFO     | __main__:main:53 - 
Dropped highly correlated features: 
['pm2_5', 'pm10', 'nh3', 'aqi_above_3_count_24h']
2026-03-01 03:25:15.365 | INFO     | __main__:main:54 - Correlation analysis completed.
2026-03-01 03:25:15.366 | INFO     | __main__:main:58 - Feature importance analysis...
2026-03-01 03:25:19.888 | INFO     | __main__:main:61 - Top feature importances: 
co                      0.187359
aqi_rolling_mean_24h    0.161188
so2                     0.124951
no2                     0.113721
aqi_rolling_max_24h     0.080574
pm2_5_pm10_ratio        0.074666
o3                      0.074041
aqi_trend               0.041177
hour                    0.033847
season                  0.029417
month                   0.025421
no                      0.021121
day                     0.019820
weekday                 0.012696
dtype: float64
2026-03-01 03:25:19.888 | INFO     | __main__:main:62 - Feature importance analysis completed.
2026-03-01 03:25:19.889 | INFO     | __main__:main:65 - Splitting data into train, validation, and test sets...
2026-03-01 03:25:19.892 | INFO     | __main__:main:68 - 
Train shape: 
(30363, 20)
 Val shape: (6506, 20)
 Test shape: (6507, 20)
2026-03-01 03:25:19.892 | INFO     | __main__:main:69 - Data splitting completed.
2026-03-01 03:25:19.892 | INFO     | __main__:main:72 - Saving features to CSV files...
2026-03-01 03:25:20.318 | INFO     | __main__:main:76 - Features saved successfully.
