2025-11-29 02:10:25.713 | INFO     | __main__:main:37 - Data Loading & Cleaning...
2025-11-29 02:10:25.850 | INFO     | src.data_cleaner:clean_data:84 - 
Data Quality Report:  
Total rows: 42608
Total columns: 10
2025-11-29 02:10:25.851 | INFO     | src.data_cleaner:clean_data:85 - 
Missing values after cleaning:  
timestamp    0
aqi          0
no           0
pm2_5        0
pm10         0
co           0
no2          0
so2          0
o3           0
nh3          0
dtype: int64
2025-11-29 02:10:25.852 | INFO     | src.data_cleaner:clean_data:86 - 
Data types: 
timestamp    datetime64[ns]
aqi                 float64
no                  float64
pm2_5               float64
pm10                float64
co                  float64
no2                 float64
so2                 float64
o3                  float64
nh3                 float64
dtype: object
2025-11-29 02:10:25.852 | INFO     | __main__:main:41 - Data Loading & Cleaning Completed.
2025-11-29 02:10:25.853 | INFO     | __main__:main:43 - Feature Engineering...
2025-11-29 02:10:25.991 | INFO     | __main__:main:46 - Feature Engineering Completed.
2025-11-29 02:10:25.991 | INFO     | __main__:main:48 - Feature Selection...
2025-11-29 02:10:25.991 | INFO     | __main__:main:50 - Performing correlation analysis...
2025-11-29 02:10:26.025 | INFO     | __main__:main:53 - 
Dropped highly correlated features: 
['pm2_5', 'pm10', 'nh3', 'aqi_above_3_count_24h']
2025-11-29 02:10:26.026 | INFO     | __main__:main:54 - Correlation analysis completed.
2025-11-29 02:10:26.026 | INFO     | __main__:main:58 - Feature importance analysis...
2025-11-29 02:10:30.682 | INFO     | __main__:main:61 - Top feature importances: 
co                      0.188449
aqi_rolling_mean_24h    0.163794
so2                     0.119774
no2                     0.113880
aqi_rolling_max_24h     0.081122
o3                      0.074922
pm2_5_pm10_ratio        0.074536
aqi_trend               0.041564
hour                    0.034728
season                  0.030089
month                   0.023957
no                      0.020547
day                     0.019787
weekday                 0.012851
dtype: float64
2025-11-29 02:10:30.683 | INFO     | __main__:main:62 - Feature importance analysis completed.
2025-11-29 02:10:30.683 | INFO     | __main__:main:65 - Splitting data into train, validation, and test sets...
2025-11-29 02:10:30.688 | INFO     | __main__:main:68 - 
Train shape: 
(29825, 20)
 Val shape: (6391, 20)
 Test shape: (6392, 20)
2025-11-29 02:10:30.688 | INFO     | __main__:main:69 - Data splitting completed.
2025-11-29 02:10:30.688 | INFO     | __main__:main:72 - Saving features to CSV files...
2025-11-29 02:10:31.111 | INFO     | __main__:main:76 - Features saved successfully.
2025-11-30 00:52:52.406 | INFO     | src.utils:read_processed_data:56 - Data read successfully from data/processed/train/aqi_train_data_v1.csv
2025-11-30 00:52:52.416 | INFO     | src.utils:read_processed_data:56 - Data read successfully from data/processed/val/aqi_val_data_v1.csv
2025-11-30 00:52:52.426 | INFO     | src.utils:read_processed_data:56 - Data read successfully from data/processed/test/aqi_test_data_v1.csv
2025-11-30 00:52:52.426 | INFO     | __main__:main:56 - Running training instance begins...
2025-11-30 00:52:52.426 | INFO     | src.train:train_model:463 - Training model...
2025-11-30 00:52:55.208 | INFO     | src.train:train_model:576 - Using TimeSeriesSplit with 3 splits
2025-11-30 00:52:55.209 | INFO     | src.train:train_model:577 - Deep learning models use 30% validation split
2025-11-30 00:52:55.209 | INFO     | src.train:train_model:580 - Training Classical ML models...
2025-11-30 00:52:55.209 | INFO     | src.train:train_model:587 - 
Fitted Features: Index(['no', 'pm2_5', 'pm10', 'co', 'no2', 'so2', 'o3', 'nh3', 'hour', 'day',
       'month', 'weekday', 'season', 'pm2_5_pm10_ratio',
       'aqi_rolling_mean_24h', 'aqi_rolling_max_24h', 'aqi_above_3_count_24h',
       'aqi_trend'],
      dtype='object')
Target used: aqi
2025-11-30 00:52:55.209 | INFO     | src.train:train_model:588 - Fitting classical ML models...
2025-11-30 00:52:55.209 | INFO     | src.train:train_model:592 - Fitting SVC model...
2025-11-30 01:17:27.560 | INFO     | src.train:train_model:592 - Fitting KNN model...
2025-11-30 01:18:09.909 | INFO     | src.train:train_model:592 - Fitting RF model...
2025-11-30 01:18:48.747 | INFO     | src.train:train_model:592 - Fitting XGB model...
2025-11-30 01:19:06.903 | INFO     | src.train:train_model:605 - Training Deep Learning models with epoch-by-epoch logging...
2025-11-30 01:19:06.903 | INFO     | src.train:train_model:610 - Training GRU model...
2025-11-30 01:23:05.256 | INFO     | src.train:train_model:610 - Training LSTM model...
2025-11-30 01:26:03.104 | INFO     | src.train:train_model:610 - Training HYBRID model...
2025-11-30 01:29:23.621 | INFO     | src.train:train_model:650 - Evaluating svc on validation set...
2025-11-30 01:29:26.082 | INFO     | src.train:train_model:689 - svc - Accuracy: 0.949, F1: 0.951, Recall: 0.949, Precision: 0.957, ROC AUC: 0.998
2025-11-30 01:29:26.085 | INFO     | src.train:train_model:735 - Classical ML model saved to: /home/runner/work/aqi-healthy-air/aqi-healthy-air/models/svc_acc_0.949_roc_0.998.pkl
2025-11-30 01:29:26.086 | INFO     | src.train:train_model:650 - Evaluating knn on validation set...
2025-11-30 01:29:28.877 | INFO     | src.train:train_model:689 - knn - Accuracy: 0.928, F1: 0.925, Recall: 0.928, Precision: 0.924, ROC AUC: 0.991
2025-11-30 01:29:28.884 | INFO     | src.train:train_model:735 - Classical ML model saved to: /home/runner/work/aqi-healthy-air/aqi-healthy-air/models/knn_acc_0.928_roc_0.991.pkl
2025-11-30 01:29:28.884 | INFO     | src.train:train_model:650 - Evaluating rf on validation set...
2025-11-30 01:29:28.934 | INFO     | src.train:train_model:689 - rf - Accuracy: 0.975, F1: 0.978, Recall: 0.975, Precision: 0.983, ROC AUC: 1.000
2025-11-30 01:29:28.974 | INFO     | src.train:train_model:735 - Classical ML model saved to: /home/runner/work/aqi-healthy-air/aqi-healthy-air/models/rf_acc_0.975_roc_1.000.pkl
2025-11-30 01:29:28.974 | INFO     | src.train:train_model:650 - Evaluating xgb on validation set...
2025-11-30 01:29:29.051 | INFO     | src.train:train_model:689 - xgb - Accuracy: 0.964, F1: 0.968, Recall: 0.964, Precision: 0.975, ROC AUC: 1.000
2025-11-30 01:29:29.059 | INFO     | src.train:train_model:735 - Classical ML model saved to: /home/runner/work/aqi-healthy-air/aqi-healthy-air/models/xgb_acc_0.964_roc_1.000.pkl
2025-11-30 01:29:29.060 | INFO     | src.train:train_model:650 - Evaluating gru on validation set...
2025-11-30 01:29:30.649 | INFO     | src.train:train_model:689 - gru - Accuracy: 0.923, F1: 0.927, Recall: 0.923, Precision: 0.934, ROC AUC: 0.992
2025-11-30 01:29:30.692 | INFO     | src.train:train_model:709 - Deep learning model saved to: /home/runner/work/aqi-healthy-air/aqi-healthy-air/models/gru_acc_0.923_roc_0.992
2025-11-30 01:29:30.693 | INFO     | src.train:train_model:710 - Deep learning model zip created: /home/runner/work/aqi-healthy-air/aqi-healthy-air/models/gru_acc_0.923_roc_0.992.zip
2025-11-30 01:29:30.693 | INFO     | src.train:train_model:715 - Deep learning model gru logged to Neptune successfully
2025-11-30 01:29:30.693 | INFO     | src.train:train_model:650 - Evaluating lstm on validation set...
2025-11-30 01:29:32.272 | INFO     | src.train:train_model:689 - lstm - Accuracy: 0.923, F1: 0.924, Recall: 0.923, Precision: 0.926, ROC AUC: 0.990
2025-11-30 01:29:32.315 | INFO     | src.train:train_model:709 - Deep learning model saved to: /home/runner/work/aqi-healthy-air/aqi-healthy-air/models/lstm_acc_0.923_roc_0.990
2025-11-30 01:29:32.316 | INFO     | src.train:train_model:710 - Deep learning model zip created: /home/runner/work/aqi-healthy-air/aqi-healthy-air/models/lstm_acc_0.923_roc_0.990.zip
2025-11-30 01:29:32.316 | INFO     | src.train:train_model:715 - Deep learning model lstm logged to Neptune successfully
2025-11-30 01:29:32.316 | INFO     | src.train:train_model:650 - Evaluating hybrid on validation set...
2025-11-30 01:29:33.829 | INFO     | src.train:train_model:689 - hybrid - Accuracy: 0.925, F1: 0.926, Recall: 0.925, Precision: 0.927, ROC AUC: 0.992
2025-11-30 01:29:33.869 | INFO     | src.train:train_model:709 - Deep learning model saved to: /home/runner/work/aqi-healthy-air/aqi-healthy-air/models/hybrid_acc_0.925_roc_0.992
2025-11-30 01:29:33.870 | INFO     | src.train:train_model:710 - Deep learning model zip created: /home/runner/work/aqi-healthy-air/aqi-healthy-air/models/hybrid_acc_0.925_roc_0.992.zip
2025-11-30 01:29:33.870 | INFO     | src.train:train_model:715 - Deep learning model hybrid logged to Neptune successfully
2025-11-30 01:29:33.872 | INFO     | src.train:train_model:768 - Best model based on F1 score: rf with F1: 0.978
2025-11-30 01:29:33.872 | INFO     | src.train:train_model:769 - Model rankings saved to: /home/runner/work/aqi-healthy-air/aqi-healthy-air/cv_results/val_model_performance.csv
2025-11-30 01:29:35.327 | INFO     | __main__:main:62 - Saving Model to Model Registry...
2025-11-30 01:29:35.327 | SUCCESS  | __main__:main:63 - Training instance complete...
